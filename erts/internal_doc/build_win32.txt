Step By Step Build Process
--------------------------

Win32 Requirements:
- All the tools mentioned in need_win32.txt.

0. Log in to the NT box.

1. On the Windows machine, start the new buildserver perl script located in
   /clearcase/otp/erts/erts/win32_tools/win32_rpc_server.plx. 

2. The following filesystems need to be shared between the NT box and 
   the Unix dito:
   A) The clearcase view you're building in. Mount it via clearcase (or NFS) 
   on the NT box, on any drive letter (which you will specify later). 
   Make sure to mount the VOB's to.
   B) gandalf:/export/home (NFS mounted) There has to be approx. 20-30 Mb free 
   on home. Mount it on H:. NOTE! This is only needed if you DON'T override
   the default temporary directories during build.

3. On the Solaris machine, cd to $(CC_ROOT) and do a 
   'clearmake -V configure_win32'.

4. cd to $(CC_ROOT)/erts/ and execute this clearmake command: 

   clearmake -V -f Makefile.win32_cross \
        NT_CC_DRIVE=<drive letter>: \
	NT_BUILDHOST=<your hostname> \
	NT_WISE_PATH=<wise dir> \
	NT_TMP_PATH=<NT view of tmp dir> \
	UNIX_TMP_PATH=<Unix view of tmp dir> \
	<target>

   where:
	<drive letter> is where you mounted your view on Windows(default L:)
	<your hostname> is the hostname of the Windows box (default beamish)
	<wise dir> is the directory where Wise is installed 
		(default d:\progra~1\wise)
	<NT view of tmp dir> is a path to a temporary directory to share
		between NT and unix (out of the view) 
		(default h:\gandalf\$USER\tmp)
	<Unix view of tmp dir> is the same as NT_TMP_PATH but as viewed by the
		unix box (default /home/gandalf/$USER/tmp)
	<target> is either 'progress_test' (default), 'progress' or 'release'. 

	Note that the UNIX_TMP_PATH will not be cleaned up, you can
	run the target win2 with the same parameters to rebuild the
	installation kit after changing the files in UNIX_TMP_PATH
	(like adding the documentation). To get the documentation in
	the Wie packet "automatically", you need a prebuilt
	documentation tar file (gzipped).  Typically you can use one
	from a daily build and test of the documentation like
	/usr/local/otp/daily_build/docs/otp_doc_html_<release number>.tar.gz.  
	Just add the make variable DOC_TAR to the
	make command line like in the example below. DOC_TAR can be
	completely omitted if you don't want to include documentation
	in the Wise package.
	
	Also note that the NT_WISE_PATH and NT_TMP_PATH are NT pathnames, with
	backslashes that need to be (single) quoted.

	Example command:
	prompt> clearmake -V -f Makefile.win32_cross NT_CC_DRIVE=N: \
	NT_BUILDHOST=saruman NT_WISE_PATH='D:\progra~1\wise' \
	DOC_TAR=/usr/local/otp/daily_build/docs/otp_doc_html_p9.tar.gz \
	NT_TMP_PATH='L:\tmp' UNIX_TMP_PATH=/ldisk/tmp release

5. When the make command is finished (some 1 hour later), you should
   have an executable file named 'otp_lxa_11930_win32_<release number>.exe' in
   $(CC_ROOT)/install_nt/wise and a newly installed OTP release on
   your NT machine. Also, if you build a 'progress_test' build, you will
   have test suites installed in C:\temp\test_suite


Problems:
 * The output from Perl run on the Windows host through an rpc to Erlang seems 
   to disappear. This is yet to be solved.

Last changed by Patrik & Raimo.


