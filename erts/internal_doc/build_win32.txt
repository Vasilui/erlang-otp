Step By Step Build Process
--------------------------

Win32 Requirements:
- OTP R4B plain (jam) installed.
- All the tools mentioned in need_win32.txt.

0. Log in to the NT box.

1. On the Windows machine, start a distributed Erlang *R4B plain jam* node 
   with the name 'buildserver', and set the cookie to 'ntbuild' 
   (-setcookie ntbuild).

2. The following filesystems need to be shared between the NT box and 
   the Unix dito:
   A) The clearcase view you're building in. Mount it via clearcase (or NFS) 
   on the NT box, on any drive letter (which you will specify later). 
   Make sure to mount the VOB's to.
   B) gandalf:/export/home (NFS mounted) There has to be approx. 20-30 Mb free 
   on home. Mount it on H:. NOTE! This is only needed if you DON'T override
   the default temporary directories during build.

3. On the Solaris machine, cd to $(CC_ROOT)/erts/autoconf/ and do a 
   'clearmake -V win32'.

4. cd back to $(CC_ROOT)/erts/ and execute this clearmake command: 

   clearmake -V -f Makefile.win32_cross \
        NT_CC_DRIVE=<drive letter>: \
	NT_BUILDHOST=<your hostname> \
	NT_WISE_PATH=<wise dir> \
	NT_TMP_PATH=<NT view of tmp dir> \
	UNIX_TMP_PATH=<Unix view of tmp dir> \
	<target>

   where:
	<drive letter> is where you mounted your view on Windows(default L:)
	<your hostname> is the hostname of the Windows box (default beamish)
	<wise dir> is the directory where Wise is installed 
		(default d:\progra~1\wise)
	<NT view of tmp dir> is a path to a temporary directory to share
		between NT and unix (out of the view) 
		(default h:\gandalf\$USER\tmp)
	<Unix view of tmp dir> is the same as NT_TMP_PATH but as viewed by the
		unix box (default /home/gandalf/$USER/tmp)
	<target> is either 'progress' (default) or 'release'. 

	Note that the UNIX_TMP_PATH will not be cleaned up, you can run the
	target win2 with the same parameters to rebuild the installation kit
	after changing the files in UNIX_TMP_PATH (like adding the 
	documentation).
	
	Also note that the NT_WISE_PATH and NT_TMP_PATH are NT pathnames, with
	backslashes that need to be quoted.

	Example command:
	prompt> clearmake -V -f Makefile.win32_cross NT_CC_DRIVE=U: \
	NT_BUILDHOST=beamish NT_WISE_PATH='D:\progra~1\wise' \
	NT_TMP_PATH='L:\tmp' UNIX_TMP_PATH=/ldisk/tmp release

5. When the make command is finished (some 1 hour later), you should have an
   executable file named 'otp_lxa_11930_nt.exe' in $(CC_ROOT)/install_nt/wise
   and a newly installed OTP release on your NT machine. Also, if you build a
   'progress' build, you will have test suites installed in
   C:\temp\test_suite


Problems:
 * The output from Perl run on the Windows host through an rpc to Erlang seems 
   to disappear. This is yet to be solved.

Last changed by Patrik.


