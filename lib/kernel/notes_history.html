<HTML>
<HEAD>
<TITLE>KERNEL Release Notes
</TITLE>
</HEAD>
<BODY BGCOLOR="#FFFFFF">
<BLOCKQUOTE>
<P>This document describes the changes made to the Kernel application.

<H2>Kernel 2.2.1</H2>
<H3>Known problems</H3>

<UL>

<LI>
If an error occurs when accessing a file, the file process
dies, and any further attempts to access the file may cause
the caller to hang.
<br>Own Id: OTP-1400<br>
Aux Id: OTP-1034


<LI>
Using <code>gen_tcp:send</code> on a closed socket causes the
process to hang.
<br>Own Id: OTP-2714<br>
Aux Id: seq 1122


<LI>
If more than 1024 bytes of text (more than 256 in release R4)
are pasted into the shell, and this text consists of
more than one expression sequence (each ending with a period),
text after the first 1024 bytes may be lost.
<br>Own Id: OTP-3041


</UL>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
global locks do now keep track of all pids that share
the same lock, i.e after two set_lock and one del_lock 
the lock is still set.
<br>Own Id: OTP-1849


<LI>
Global may have exited if bursty nodeup/nodedowns was 
received to a node. This is solved now.
<br>Own Id: OTP-2766<br>
Aux Id: otp-2728, otp-2928


<LI>
Changes of the kernel configuration parameter 'distributed' 
are now taken care of at release upgrade. 
Kernel will however not automatically move applications  
to the nodes with highest priority; this must be done
manually after the release upgrade is finished
(use application:takeover/2).
<br>Own Id: OTP-2830


<LI>
If a transient application exited with reason normal
application_controller crashed; this malfunction is now
corrected.
<br>Own Id: OTP-2955<br>
Aux Id: seq1445


<LI>
If a system is started and a permanent application
has erroneous environment parameters, the system should
crash. This is the behaviour now, before the system
only printed an error report. 
The system will only crash if the application is
started from a boot script genrated by calling
systools:make_script/1/2 
If application:start/1/2 is called the behaviour is as before. 
<br>
Note: affects the result of the systools:make_script/1/2.
systools:make_script generates now a call to 
application:start_boot/2 instead of as prevoiusly a call to
application:start/2.
<br>Own Id: OTP-3002


<LI>
applicaition:get_application(module_name) returned 'undefined'
if the module_name was defined as {module_name, Vsn} in the
.app-file
<br>Own Id: OTP-3081<br>
Aux Id: Seq 1618


<LI>
The possible InternalStatus <CODE>stopping</CODE> was missing in
the documentation for <CODE>init:get_status/0</CODE>.
<br>Own Id: OTP-3096<br>
Aux Id: Seq 1672


<LI>
when opening an externally formatted disk log the header
was not written to the files.
<br>Own Id: OTP-3118


<LI>
application:permit can now handle also applications
which are only loaded (but not started).
<br>Own Id: OTP-3119


<LI>
When reading a wrap log and for some reason a file
was missing an error was given and it was not possible
to read further. 
Now a missing file will result only in an error log
message and it is possible to continue reading the log.
<br>Own Id: OTP-3136<br>
Aux Id: OTP-3137


<LI>
It is now possible to open an existing wrap log without 
giving the size parameter. The last given values will 
be used as default values.
<br>Own Id: OTP-3147


</UL>
<H3>Improvements and new features</H3>

<UL>

<LI>
It is now possible to change the size of an open disk log.
For a halt log it is always possible to increase the size, 
but it is not possible to decrease the size to be less than 
the current size of the file. For a wrap log it is always 
possible to increase both the size and number of files. 
If the max files is decreased the redundant files will be
removed next time the log wraps. If the size of the
files is decreased the change will not affect the logs
already full.
If the log size is decreased for instance to save space, 
the function inc_wrap_log/1 can be used to force the log
to wrap.
<br>Own Id: OTP-2999<br>
Aux Id: OTP-2989,OTP-2990,seq 1499


<LI>
It is possible to force the disk_log to change to next 
wrap log file by calling the new function 
disk_log:inc_wrap_log(Log). This makes the current file 
to be closed and the next index file is opened.
<br>Own Id: OTP-3078<br>
Aux Id: Seq 1607


<LI>
The undocumented and not recommended BIFs <CODE>erlang:spawn/2</CODE>
and <CODE>erlang:spawn_link/2</CODE> will disappear in OTP R6, to
be replaced with a more consistent set of BIFs for spawning
processes from funs.
<br>Own Id: OTP-3141<br>
Aux Id: OTP-3121


</UL>
<H2>Kernel 2.2</H2>

<UL>

<LI>
If an error occurs when accessing a file, the file process
dies, and any further attempts to access the file may cause
the caller to hang.
<br>Own Id: OTP-1400<br>
Aux Id: OTP-1034


<LI>
<CODE>code:is_loaded/1</CODE> doesn't type check its arguments.
<br>Own Id: OTP-2607


<LI>
If more than 1024 bytes of text (more than 256 in release R4)
are pasted into the shell, and this text consists of
more than one expression sequence (each ending with a period),
text after the first 1024 bytes may be lost.
<br>Own Id: OTP-3041


</UL>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
<CODE>net_adm:names</CODE> did not always return the correct result
when epmd on the own host was called on Windows or Linux. This
is now corrected.
<br>Own Id: OTP-2851<br>
Aux Id: OTP-2840


<LI>
Some BIFs e.g <CODE>append</CODE> could during certain circumstances
consume huge amounts of memory (causing the Erlang node to crash) before
the garbage collector was invoked to free the unused memory. This is
now corrected.
<br>Own Id: OTP-2865<br>
Aux Id: Seq 1337


<LI>
When a heart command is set with <CODE>heart:set_cmd(Command)</CODE>
the length is miscalculated which results in 2 garbage 
characters at the end of the command. This can cause the 
heart command to fail if the garbage characters are other
chars then SPACE or NULL.
This is now corrected.
<br>Own Id: OTP-2903<br>
Aux Id: Seq 1372


<LI>
I thought I already had written the release note for thisx
<br>Own Id: OTP-2911<br>
Aux Id: Seq 1384


<LI>
Previously <CODE>gen_tcp:accept</CODE> erroneously could return 
<CODE>{error,normal}</CODE>. This is now corrected.
<br>Own Id: OTP-2954<br>
Aux Id: Seq 1374, OTP-2904


<LI>
A request to start a distributed application, which already
was started, caused that the application controller hanged.
This malfunction is now corrected.
<br>Own Id: OTP-2967<br>
Aux Id: Seq 1474


<LI>
Two processes starting the same application on the same node
at the same time actually started the application twice. 
<br>
Now the systems keeps track of all the start requests and
starts the application only once. The result of the
start is returned to all requesters.
<br>Own Id: OTP-2973<br>
Aux Id: Seq 1461


<LI>
A local application would not start when its permission
was set to true if it was initially started with permission
set to false.
<br>Own Id: OTP-2974


<LI>
The error returns from the functions in the <CODE>rpc</CODE> module
were not consistent: if <CODE>{badrpc, {'EXIT', Reason}}</CODE> was
reported for remote nodes, only <CODE>{badrpc, Reason}</CODE> was
reported for the local node.
Now, <CODE>{badrpc, {'EXIT', Reason}}</CODE> is reported in both
cases.
<br>(*** POTENTIAL INCOMPATIBILITY ***)
<br>Own Id: OTP-3007<br>
Aux Id: OTP-2875


<LI>
<CODE>net_adm:localhost/0</CODE> is corrected to not append a
"." to the hostname if the domain is not set (i.e when the 
domain is the empty string).
<br>Own Id: OTP-3013<br>
Aux Id: Seq 1533


<LI>
On Unix, if there were no current working directory for an
Erlang node (if another Unix process has deleted the directory),
the commands <CODE>c:pwd/0</CODE>, <CODE>m/0</CODE>, and <CODE>m/1</CODE> would
crasch.  The <CODE>pwd</CODE> has been corrected to print
"Cannot determine current directory" if there are no current
directory, and the other commands do not attempt to convert
absolute pathnames to relative pathnames as they usually do.
<br>Own Id: OTP-3015<br>
Aux Id: Seq 1537


<LI>
When starting the emulator with the <CODE>-noshell</CODE> switch,
a "^R" marker was printed if reading and writing on the
console was mixed.  This marker is no longer printed.
<br>Own Id: OTP-3085<br>
Aux Id: Seq 1629


</UL>
<H3>Improvements and new features</H3>

<UL>

<LI>
Functions have been added to the <CODE>file</CODE> module to
handle links.  The <CODE>read_link_info/1</CODE> reads information
about a symbolic link, and the <CODE>read_link/1</CODE> function
returns what a symbolic link is actually pointing to.
The <CODE>make_link</CODE> function creates a new hard link,
and the <CODE>make_symlink</CODE> function creates a new symbolic link.
<br>Own Id: OTP-1385<br>
Aux Id: OTP-3008


<LI>
It is now possible to reconfigure global groups. The 
parameter name is changed from node_groups to global_groups.
<br>Own Id: OTP-2497<br>
Aux Id: OTP-1559


<LI>
<CODE>gen_udp:recv/3</CODE> has been added, in analogy with
<CODE>gen_tcp:recv/3</CODE>,
and <CODE>gen_udp:recv/[2,3]</CODE> are now documented.
<br>Own Id: OTP-2645


<LI>
Allowed number of files in a wrap log is increased from 255
to 65000.
<br>Own Id: OTP-2748<br>
Aux Id: seq 1204


<LI>
<CODE>gen_tcp:connect/[3,4]</CODE> take the same options as
<CODE>gen_udp:open/[1,2]</CODE>, in particular the <CODE>binary</CODE>
option. This is not new in R5, but was
left out of the documentation.
<br>Own Id: OTP-2814<br>
Aux Id: Seq 1250


<LI>
The syntax of Erlang tokens has been extended to
allow the use of the full ISO-8859-1 (Latin-1)
character set. This is noticeable in the following
ways: all the Latin-1 printable characters can be used
and are shown without the escape backslash convention;
atoms and variables can use all Latin-1 letters.
<br>Own Id: OTP-2985


<LI>
The disk_log wrote a header every time a log file was opened,
now the header is only written once in each file.
<br>Own Id: OTP-3014<br>
Aux Id: Seq 1534


<LI>
A new open mode, <CODE>append</CODE>, has been added to the
<CODE>file:open/2</CODE> function.
<br>Own Id: OTP-3067

</UL>


<H2>Kernel 2.1.1</H2>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
<CODE>ets:file2tab</CODE> which uses <CODE>disk_log</CODE> now uses the <CODE>read_only</CODE> option to <CODE>disk_log:open</CODE>
when it opens the file.
<br>Own Id: OTP-1716<br>
Aux Id: OTP-1765


<LI>
All applications are now informed of all changed, new and
removed configuration parameters at installation of a
new release. The new call-back functions is defined as
Mod:config_changed(Changed, New, Removed).
Where Mod is the module defined in the .app file.
Refer to the reference manual application(3).
<br>Own Id: OTP-2012


<LI>
When killing a shell in the ^G command level using the
sequence "^G k", some processes associated with the
shell were left running. Now, there are no extra processes
left anymore.
<br>Own Id: OTP-2317


<LI>
The function <CODE>gen_tcp:controlling_process(S, NewOwner)</CODE> did hang
the calling process if it was not the current owner of <CODE>S</CODE>.
This is now corrected. If called by any other process than the current
owner <CODE>{error, eperm}</CODE> will be returned.
<br>Own Id: OTP-2321<br>
Aux Id: seq 779


<LI>
When application environment variables are given on the
command line, no error message was given if the variable's
value was malformed; application:get_env/2 simply returned
'undefined'. Now, application:start/1
returns an error in those cases.
<br>(*** POTENTIAL INCOMPATIBILITY ***)
<br>Own Id: OTP-2350<br>
Aux Id: OTP-2347, OTP-2348


<LI>
If a process attempts to call erl_ddll:unload_driver/1 on
a driver for which it didn't previously call
erl_ddll:load_driver/2, the unloading
fails. In previous release, either the result 'ok' was
returned, or in certain cases the erl_ddll server
crashed. Now the correct error tuple is returned.
<br>(*** POTENTIAL INCOMPATIBILITY ***)
<br>Own Id: OTP-2568


<LI>
Sometimes when a R3 node and a R4 node were connected, global 
could crash due to not checked '{badrpc,nodedown}' messages. 
This is now corrected.
<br>Own Id: OTP-2648<br>
Aux Id: Seq 987


<LI>
The processes which controls a port corresponding to a 
socket is now set to priority high instead of normal 
to assure that e.g node-ticks between 
distributed nodes are sent fast enough.
<br>Own Id: OTP-2709


</UL>
<H3>Improvements and new features</H3>

<UL>

<LI>
The documentation has been augmented with a description of
the error return values from erl_ddll:load_driver/2 and
erl_ddll:unload_driver/1, and the error formatting function
format_error/1.
<br>Own Id: OTP-2569


<LI>
The 'backlog' option to gen_tcp:listen/2 is now documented.
<br>Own Id: OTP-2674


</UL>
<H2>Kernel 2.1</H2>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
For the arguments to the command-line option -s, the
documentation was incorrect. It has been changed to reflect
the actual behaviour, namely that all arguments to the
function called by -s are passed as atoms.
<br>Own Id: OTP-2087


<LI>
When using the -boot and -config command-line options
on Windows, filenames in the native Windows syntax using
only backslashes didn't work -- forward slashes had to be
used. Now backslashes work as well as forward slashes.
<br>Own Id: OTP-2373


<LI>
An unnecessary report to the error logger caused by a timeout from
<CODE>inet:gethostbyname</CODE> and <CODE>inet:gethostbyaddr</CODE> is removed.
<br>Own Id: OTP-2478


</UL>
<H3>Improvements and new features</H3>

<UL>

<LI>
New start type, {failover, node()}, added. Note, 
for compability reasons this is only valid if the new key
<CODE>start_phases</CODE> is defined in the <CODE>.app</CODE>-file 
for the application, refer to <CODE>application (3)</CODE>.
It is also possible to check the current start type
by <CODE>application:start_type()</CODE>, refer to 
<CODE>application (3)</CODE>
<br>Own Id: OTP-1504<br>
Aux Id: OTP-1979, OTP-2498


<LI>
A first increment to allow several global name spaces
to exist in the same system. The Global Groups are
defined in the .config file by the key '{node_groups,
[{GroupName, [Node]}]}. 
If the node_groups-key is not defined the system 
behaves as before; if the Global Group service
is used then it is required that all nodes in a system
are defined in one. and only one, Global Group.
It is not possible to mix nodes belonging to
a global group and nodes not belonging to a global
group in the same system, if global group functionality 
is used.
<br>
Missing functionality: Reconfiguration, at the moment
it is not possible to change the configuration without 
restarting all nodes.
<br>Own Id: OTP-1559<br>
Aux Id: OTP-2497


<LI>
Better error messages for erroneous .config file.
<br>Own Id: OTP-1983


<LI>
The functions <CODE>write_file_info/2</CODE>, <CODE>change_owner/2,3</CODE>,
and <CODE>change_time/2,3</CODE> in the <CODE>file</CODE> module are
now documented.
<br>Own Id: OTP-2252<br>
Aux Id: seq 710


<LI>
It is now possible to synchronize the start of an
application by defining a new key in the <CODE>.app</CODE>
file, {start-phases, [{Phase, Args}]}. This will result
that the new call back function 
<CODE>Mod:start_phase(Phase, Args)</CODE> is called, Mod is
the module defined in the <CODE>mod</CODE> key of the
application.
There is also a generic help module to syncronize the
start of included applications, <CODE>application_starter</CODE>.
If this module is defined in the <CODE>mod</CODE> key for 
the top application, the included applications
will be started in each start phase in the order
of appearance in the <CODE>included_applications</CODE> 
key.
<br>Own Id: OTP-2498<br>
Aux Id: OTP-1504


<LI>
It is added to the documentation of <CODE>file:list_dir/1</CODE> that
the returned filenames are not sorted.
<br>Own Id: OTP-2508<br>
Aux Id: seq 891


<LI>
A new key, <CODE>id</CODE>, in the application resource file 
(<CODE>.app</CODE>, ). It can be used to define the product
identification of the application.
<br>Own Id: OTP-2518


<LI>
The description of error_handler:undefined_global_name/2
has been removed, since it's no longer called from
Erlang 4.6 and later.
<br>Own Id: OTP-2525


<LI>
Sequential tracing is available in alfa status and only
for JAM systems. Since it is an alpha release the 
programmatic interface could be slightly changed based on
experience from users. The module <CODE>seq_trace</CODE>
contains the interface.
Sequential tracing makes it possible to trace all messages
that are a direct result from one initiating message
e.g. all messages in a call-setup for one connection.
<br>Own Id: OTP-2527


<LI>
It is now possible to read an application's resource file
(.app) keys. New functions:
application:get_all_key()
application:get_all_key(Application)
application:get_key()
application:get_key(Application, Key)
<br>Own Id: OTP-2535


</UL>

<H2>R3B02 (Kernel 2.0.5)</H2>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
The description of the options <CODE>resuaddr</CODE> and <CODE>keepalive</CODE>
in <CODE>inet:setopts/2</CODE> has been corrected.
<br>Own Id: OTP-2223<br>
Aux Id: seq 679


<LI>
The reference manual for the <CODE>kernel</CODE> application is corrected
regarding the <CODE>boot_server_slaves</CODE> variable. The value
should be a list of slave IP-addresses and not a list of nodenames as stated earlier.
<br>Own Id: OTP-2224<br>
Aux Id: seq 680


<LI>
<CODE>application:permit(App, false)</CODE> may hang during certain circumstances. This is corrected.
<br>Own Id: OTP-2231<br>
Aux Id: seq699 HA72879


<LI>
The Erlang system did always contact the DNS server (if configured)
on startup and this could cause the system to hang. This is now
corrected.
<br>Own Id: OTP-2308<br>
Aux Id: seq 765


<LI>
<CODE>dist_ac</CODE> could hang forever if a nodedown was received
at certain times.
<br>Own Id: OTP-2368<br>
Aux Id: seq813


</UL>
<H2>R3B01 (Kernel 2.0.4)</H2>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
The <CODE>-pa</CODE> and <CODE>-pz</CODE> options to <CODE>erl</CODE> did not
add the paths to the code server when combined with the
<CODE>-mode embedded</CODE> option. This is corrected.
<br>Own Id: OTP-2160<br>
Aux Id: seq 644


</UL>
<H2>R3B (Kernel 2.0.3)</H2>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
The file:sync/1 used to crash the process for the file it was used on;
this has been corrected.
<br>Own Id: OTP-1778<br>
Aux Id: seq379


<LI>
os:cmd/1 used to hang if given a command containing a
shell comment character, for example: os:cmd("ls #").
This has been corrected.
<br>Own Id: OTP-1805<br>
Aux Id: seq 385


<LI>
The 'EXIT' reason reported from the BIF process_info/1 
is corrected; it now reports 'badarg' when the argument 
is not a pid.
<br>Own Id: OTP-1874


<LI>
The documention for erlang:register/2 has been reworded
to clarify that a registered name can be used by the
send operation, rather than generally.
<br>Own Id: OTP-1875


<LI>
The call to erl_ddll:unload_driver for a statically linked
in driver now returns {error,linked_in_driver}. Previously
the incorrect result {error, not_loaded} was returned.
<br>(*** POTENTIAL INCOMPATIBILITY ***)
<br>Own Id: OTP-1962


<LI>
global:(un)register_name is changed to set lock only on
the nodes known to the global_name_server.
<br>Own Id: OTP-2011


<LI>
When the <CODE>pg2</CODE> server is started and a new disk log is
opened, the call to <CODE>disk_log:open</CODE> used to crash.
This has been corrected.
<br>(*** POTENTIAL INCOMPATIBILITY ***)
<br>Own Id: OTP-2028


<LI>
A more informative error messages is displayed if you try to start
an Erlang node with the same name as an existing.  The message
in R3A was cryptic.
<br>Own Id: OTP-2032<br>
Aux Id: seq 534


<LI>
The reference manuals for modules <CODE>gen_tcp</CODE>, <CODE>gen_udp</CODE> and
<CODE>inet</CODE> are corrected.
<br>Own Id: OTP-2034<br>
Aux Id: seq 527


<LI>
When loading of a module fails (for instance, because of a
corrupted file), the code server will print an error report
which includes the name of the file.
The error messages printed by the binary loader are still
printed, however.  In a future version, there will be ONE
message printed, and it will be more informative.
<br>Own Id: OTP-2049<br>
Aux Id: seq 546


<LI>
In UNIX when the resolver file (typically /etc/resolv.conf) 
is not found,
this is not treated as an error any more. 
A warning is issued and
this type of warning is disabled as default.
The warning messages can be turned on with the kernel 
environment variable
<CODE>inet_warnings = on</CODE>.
<br>Own Id: OTP-2053<br>
Aux Id: seq 552


<LI>
The communication between distributed Erlang nodes could hang if one of
the nodes suddenly dies. The cause was incomplete error handling in the
inet_* modules and the inet-driver. This is corrected.
<br>Own Id: OTP-2055<br>
Aux Id: seq 549


<LI>
There was a problem (in R3A) on Windows NT , that it was impossible
to make contact between two Erlang nodes on the same machine if
the machine was not configured to use DNS and did also not have it's own
hostname in a lmhosts file. This is corrected.
<br>Own Id: OTP-2061<br>
Aux Id: seq 572, seq 573


<LI>
The documentation has been updated to cover VxWorks too.
<br>Own Id: OTP-2157


</UL>
<H3>Improvements and new features</H3>

<UL>

<LI>
The documentation for <CODE>erlang:process_info(Pid, status)</CODE>
now lists the <CODE>suspended</CODE> state as a possible return value.
<br>Own Id: OTP-2105<br>
Aux Id: seq 601


<LI>
The timeouts for <CODE>heart</CODE> are now configurable.
The environment variable HEART_BEAT_TIMEOUT can be used
to set the maximum time that heart accept without getting
any heart beat message from the Erlang node.
Another variable HEART_BEAT_BOOT_DELAY can be used to set
the delay time before the hardware watchdog (if any) is
triggered. This is used to reserve time for closing down the
system in a proper way without interference from the watchdog.
Both variables can have values in seconds and must be in the 
range 10 < x <= 65535. If the variable(s) are not set the
default value is 60 seconds for both timeouts.
<br>Own Id: OTP-2143


<LI>
It is now possible to tell the Erlang node to try with
<CODE>dns</CODE> even if ONLY <CODE>nis</CODE> or <CODE>nis+</CODE> and 
not <CODE>dns</CODE> is specified
in the <CODE>/etc/nsswitch.conf</CODE> file. This can be activated
with the kernel valiable <CODE>inet_dns_when_nis</CODE> set to 
<CODE>true</CODE>. The variable can be set in the start script
or on the command line like this: <CODE>erl -kernel inet_dns_when_nis true</CODE>.
<br>Own Id: OTP-2153


</UL>
<H2>R3A02</H2>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
The erlang distribution did not work if the search entry
in /etc/resolv.conf was missing. This is corrected.
<br>Own Id: OTP-2036<br>
Aux Id: seq 542


<LI>
The required format of domain and hostnames is relaxed. Now
the requirement is that the name only consists of
visible characters (16#21..16#7E).
<br>Own Id: OTP-2037<br>
Aux Id: seq 543


</UL>
<H2>R3A (Kernel 2.0)</H2>
<H3>Fixed errors and malfunctions</H3>

<UL>

<LI>
An application can be loaded even if it includes another
application which is not yet loaded.
<br>Own Id: OTP-1586


<LI>
Now the tty is reset correctly when leaving Erlang.
<br>Own Id: OTP-1654


<LI>
disk_log always truncated internal wrap logs;
this is corrected.
<br>Own Id: OTP-1869


<LI>
The call to pg2:get_closest_pid exited if the process group
has no members. This is corrected.
<br>(*** POTENTIAL INCOMPATIBILITY ***)
<br>Own Id: OTP-1945


</UL>
<H3>Improvements and new features</H3>

<UL>

<LI>
Start of applications is now more asynchronous, in order
to prevent deadlock if a starting application calls
<CODE>application:start</CODE> and  <CODE>which_applications</CODE>.
<br>Own Id: OTP-1629


<LI>
The application_controller now uses less memory for
the storage of application specifications
<br>Own Id: OTP-1630


<LI>
The documentation about how to start distributed applications
is improved.
<br>Own Id: OTP-1631


<LI>
Improvements in the <CODE>disk_log</CODE> module: Log name is printed
from the <CODE>info</CODE> function. A Pid is deleted from log owners
when the Pid dies or calls close. Reconfiguration of logs
is now handled correctly.
<br>Own Id: OTP-1634<br>
Aux Id: OTP-1435


<LI>
The <CODE>application_controller</CODE> is split into two processes;
one that handles local applications and one that handles
the distributed applications. If distributed applications
are used, the configuration parameter <CODE>start_dist_ac</CODE>
should be set.
<br>Own Id: OTP-1636


<LI>
The new functions pwrite and pread are added to the file 
module. These functions makes read and write on a specific
position in a file more efficient.
<br>Own Id: OTP-1640


<LI>
The syntax of different files defined by Kernel is described
in separate documents. Se the reference manual for <CODE>app(4)</CODE>		and <CODE>config(4)</CODE>.
<br>Own Id: OTP-2149


</UL>
<H3>Known problems</H3>

<UL>

<LI>
It is currently not possible to open a <c>disk_log</c> for
reading only. The same limitation applies to <c>ets:file2tab</c>.
We consider this to be a bug which will be fixed in a forthcoming
version.
<br>Own Id: OTP-1716


</UL>

<A NAME="1"><!-- Empty --></A><H2>1 Kernel 1.3.2</H2><A NAME="1.1"><!-- Empty --></A><H3>1.1 Fixed Bugs and malfunctions</H3><P><UL>
<LI>     <CODE>file:stop</CODE> does not hang any more.
         <BR>
Own Id:OTP-1404

        <BR>
<LI>     <CODE>net_kernel</CODE> could in some situations send two
         nodeup messages to the monitor processes (processes that
         have evaluated <CODE>net_kernel:monitor_nodes()</CODE>).

         <BR>
This problem could make <CODE>global</CODE> hang when several
         nodes connected.

         <BR>
Own Id:OTP-1418; OTP-1127, OTP-1412
         <BR>
Aux Id:tir-d-088

        <BR>
<LI>     <CODE>net_kernel</CODE> did not send nodedown messages for
         allowed nodes. If net_kernel:allow(Nodes) was used, no
         nodedown messages at all were sent to monitor processes
         net_kernel.

         <BR>
nodedown messages are now sent for allowed nodes but are
         ignored for connection attempts from disallowed nodes.

         <BR>
Own Id:OTP-1419

        <BR>
<LI>     <CODE>application_controller</CODE> had sync problems in the
takeover phase when an application was remote started.

         <BR>
Own Id:OTP-1426

        <BR>
<LI>     <CODE>application_controller</CODE> did sometimes report
         <CODE>{error,{not_started,App}}</CODE> even though the
         application in question has been started on another node.

         <BR>
Own Id:OTP-1454
         <BR>
Aux Id:HA52440

        <BR>
<LI>     <CODE>application_controller</CODE> could hang due to a
         deadlock situation during startup in a distributed system.

         <BR>
Own Id:OTP-1472

<BR>
</UL>
<A NAME="1.2"><!-- Empty --></A><H3>1.2 Improvements and new features</H3><P><UL>
<LI>     The support for dynamic loading of drivers in module <CODE>erl_ddll</CODE> is enhanced with
         reference counting of loaded drivers and automatic unloading of drivers when the &#34;owner&#34;
         process terminates.
         <BR>
Own Id:OTP-1460
        <BR>
<LI>     The <CODE>os</CODE> module has got 2 new functions <CODE>getenv/1</CODE> to read environment variables from the hos operating system and <CODE>find_executable/1,2</CODE> to find executable programs using a
         search path.
         <BR>
Own Id:OTP-1461
        <BR>
<LI>     A new function <CODE>application:which_application(Module)</CODE> which returns the 
         application that <CODE>Module</CODE> belongs to.
         <BR>
Own Id:OTP-1008
<BR>
</UL>
<A NAME="2"><!-- Empty --></A><H2>2 Kernel 1.3.1</H2><A NAME="2.1"><!-- Empty --></A><H3>2.1 Fixed Bugs and malfunctions</H3><P><UL>
<LI>     Malformed string/list as argument to unix:cmd/1 caused entire
         ERTS to crash.
         <BR>
Own Id: OTP-1384
        <BR>
<LI>     It was not possible to convert a non distributed system
         into a distributed system as stated in the net_kernel
         reference manual.
         Note that this is not the recommended way to start a
         distributed system.
         <BR>
Own Id: OTP-1393
        <BR>
<LI>     <CODE>net_adm:world/1</CODE> was broken on Windows NT, since it relied
         on <CODE>unix:cmd/1</CODE>.
         <BR>
Own Id: OTP-1397
        <BR>
<LI>     The <CODE>disk_log_server</CODE> now clears it's state correctly 
                when a disk_log process terminates.
         <BR>
Own Id: OTP-1402
<BR>
</UL>
<A NAME="3"><!-- Empty --></A><H2>3 Kernel 1.3</H2><A NAME="3.1"><!-- Empty --></A><H3>3.1 Improvements and new features</H3><P><UL>
<LI>     <CODE>net_ticktime</CODE> is configurable through the <CODE>kernel</CODE>
         application. <CODE>net_ticktime</CODE> specifies the time within which
         a non responding node will be considered to be down.

        <BR>
<LI>     <CODE>-boot_var</CODE> flag read by <CODE>init</CODE>. This flag is used
         to set a path variable in the boot script. If applications
         will be placed under another directory than $ROOT/lib in an
         embedded system this flag can be used.
        
        <BR>
<LI>     A new function for controlling execution of applications
         is added; <CODE>application:permit/2</CODE>. The function
         controls which applications are permitted to execute on
         the node.

        <BR>
<LI>     A new configuration parameter <CODE>permissions</CODE>
         specifies the default permission an application has when
         it is loaded.

        <BR>
<LI>New functions in <CODE>application</CODE>. <BR>

         <CODE>application:load(App, Dist)</CODE> - set (and check!)
         distribution configuration for an application at load
         time.<BR>
 <CODE>application:get_application/0,1</CODE> - get the
         application of a pid.
         <BR>
Own Id: OTP-1306

        <BR>
<LI><CODE>.config</CODE> files are now allowed to contain
         comments.
         <BR>
Own Id: OTP-1134
         <BR>
Aux Id: HA37561

        <BR>
<LI>It is now possible to specify more than one
         configuration file to <CODE>erl</CODE>, by using the command
         line flag <CODE>-config</CODE>.

        <BR>
<LI>     The code server (module <CODE>code</CODE>) did sometimes store
         relative pathnames which could cause troubles in some cases. 
         The code server is changed to always store absolute pathnames.
         <BR>
Own Id: OTP-1239
         <BR>
Aux Id: erlang/66

        <BR>
<LI>     An elucidation regarding strings in the <CODE>code</CODE> module.
         Since the <CODE>1.1</CODE> version of the kernel application the
         <CODE>code</CODE> module always returns directory (and file) names as
         strings. See the <CODE>code(3)</CODE> manual page.
         <BR>
It is preferable that directory names are provided as strings
         to all functions. The possibility to provide directory names
         as atoms may be removed in future releases. Module names
         should always be given as atoms and the possibility to provide
         module names as strings may be removed in future releases.
         <BR>
Own Id: OTP-1186

        <BR>
<LI> <CODE>code:priv_dir/1</CODE> was very slow and is made
         much faster now. <BR>
Own Id: OTP-1339

        <BR>
<LI>The module <CODE>disk_log</CODE> is moved from
         <CODE>stdlib</CODE> to <CODE>kernel</CODE>, and some new functionality
         is added. <CODE>disk_log</CODE> supports wrap and halt logs,
         the size of a log is configurable, it supports different
         file formats, and it supports replicated logs.
         <BR>
Own Id: OTP-1305

        <BR>
<LI>     The <CODE>erl_boot_server</CODE> is dynamically configurable.
         <BR>
Own Id: OTP-1275

        <BR>
<LI>     The functions <CODE>add_slave/1</CODE>, <CODE>delete_slave/1</CODE> and
         <CODE>which_slaves/0</CODE> are added to the <CODE>erl_boot_server</CODE>.

        <BR>
<LI> New option <CODE>raw</CODE> to <CODE>file:open</CODE> and also a
         new variant of the function which takes a list of
         options. The open with an optionlist is the recommended
         way to open a file from no on.
         <BR>
Own Id: OTP-1242

        <BR>
<LI>     New format for the <CODE>Reason</CODE> field when <CODE>{error,Reason}</CODE>
         is returned from functions in the <CODE>file</CODE> module. There is
         also new documentation about this in the reference manual.
         <BR>
Own Id: OTP-1075
        <BR>
<LI> The configuration parameter <CODE>os</CODE> is removed
         from <CODE>kernel.app</CODE>. The function <CODE>os:type()</CODE> is
         used instead.
         <BR>
Own Id: OTP-1277
         
<BR>
</UL>
<A NAME="3.2"><!-- Empty --></A><H3>3.2 Fixed Bugs and malfunctions</H3><P><UL>
<LI>     <CODE>net_adm:world()</CODE> is corrected on Windows NT.
         <BR>
Own Id: OTP-1219
        <BR>
<LI>    <CODE>file:list_dir(&#34;c:&#34;)</CODE> returns &#34;No such file...&#34; on NT
        <BR>
Own Id:OTP-1237
        <BR>
<LI>     Bad call to <CODE>c:c/1</CODE> did crash the Erlang shell.
         Solved by addition of a better test that a module name is correct.
         <BR>
Own Id: OTP-1256
         <BR>
Aux Id: erlang/73

        <BR>
<LI>     The <CODE>rpc:cast</CODE> function was synchronous when casted function
         call was performed at the current node.
         <BR>
Own Id: OTP-1292
        <BR>
</UL>
<A NAME="3.3"><!-- Empty --></A><H3>3.3 Incompatibilities with Kernel 1.1.1</H3><P><UL>
<LI>     New format for the <CODE>Reason</CODE> field when <CODE>{error,Reason}</CODE>
         is returned from functions in the <CODE>file</CODE> module. 
         This is an interface change (the format of <CODE> Reason</CODE> but
         it will only break a minimal amount (if any) of old code since
         the previous format of <CODE>Reason</CODE> was more or less useless
         in match operations. There where also errors in the documentation
         and other inconsistencies with the old format.
         <BR>
The most likely places where old code needs to be adjusted is where the highlevel functions <CODE>consult</CODE>, <CODE>path_consult</CODE>, <CODE>eval</CODE> and <CODE>path_eval</CODE> in combination with a match for the result <CODE>{error,open}</CODE> is used.
         <BR>
Own Id: OTP-1075
        <BR>
</UL>
<A NAME="3.4"><!-- Empty --></A><H3>3.4 Known bugs and problems</H3><P>-
<A NAME="4"><!-- Empty --></A><H2>4 Kernel 1.1.1</H2><A NAME="4.1"><!-- Empty --></A><H3>4.1 Improvements and new feature</H3><P>-
<A NAME="4.2"><!-- Empty --></A><H3>4.2 Fixed Bugs and malfunctions</H3><P><UL>
<LI>     <CODE>application:get_env/1</CODE> returned <CODE>undefined</CODE>
         for all parameters during startup of an application.

         <BR>
Own Id: OTP-1079

        <BR>
<LI>     When synchronization of mandatory node fails using the
         <CODE>sync_nodes_mandatory</CODE> configuration parameter , the
         node should be takendown, but it wasn't.

         <BR>
Own Id: OTP-1083

        <BR>
<LI>     Manual page for file corrected.

         <BR>
Own Id: OTP-1102

        <BR>
<LI>     Attempt to start an application when already running
         causes error. Now <CODE>application:start/1,2</CODE> returns
         <CODE>{error,{already_started,Name}}</CODE> if the application
         is running.

         <BR>
Own Id: OTP-1111
         <BR>
Aux Id: tir-f-087, tir-d-087

        <BR>
<LI>     Restart (<CODE>init:restart/0</CODE>) of system did not work
         after a software upgrade. Started using the now old
         version.

         <BR>
Own Id: OTP-1113
         <BR>
Aux Id: HA37170

        <BR>
<LI>     <CODE>init:stop/0</CODE> did not work after a restart
         (<CODE>init:restart/0</CODE>).

         <BR>
Own Id: OTP-1117

<BR>
</UL>
<A NAME="4.3"><!-- Empty --></A><H3>4.3 Incompatibilities with Kernel 1.1</H3><P>-
<A NAME="4.4"><!-- Empty --></A><H3>4.4 Known bugs and problems</H3><P>-
<A NAME="5"><!-- Empty --></A><H2>5 Kernel 1.1</H2><A NAME="5.1"><!-- Empty --></A><H3>5.1 Improvements and new feature</H3><P><UL>
<LI>     Application configuration paramaters can be given from
         the command line (overrides the configuration file):<BR>
<PRE>erl -Appl Key Value</PRE>

        <LI>     Load applications before start. All applications (included
         in the boot script) are loaded before the first application is
         started.

        <BR>
<LI>     Heart uses the hardware watchdog (Solaris), see heart(3).

        <BR>
<LI>     Added <CODE>error_logger:info_msg/1,2</CODE>.

        <BR>
<LI>     Support for distributed applications enhanced and
         documented.

<BR>
</UL>
<A NAME="5.2"><!-- Empty --></A><H3>5.2 Fixed Bugs and malfunctions</H3><P><UL>
<LI>     <CODE>net_adm:ping(Node)</CODE> will never return <CODE>pong</CODE>
         if this node is not allowed (<CODE>net_kernel:allow/1</CODE>) to
         connect to <CODE>Node</CODE>.

        <BR>
<LI>     <CODE>net_kernel:allow/1</CODE> handles hidden nodes. 

<BR>
</UL>
<A NAME="5.3"><!-- Empty --></A><H3>5.3 Incompatibilities with OTP P1G</H3><P><UL>
<LI>     A configuration file must have suffix .config. (For example,
         to use the file sys.config, erl -config ./sys is used)
         
        <BR>
<LI>     Old boot scripts won't work - generate new with systools.

        <BR>
<LI>     Added the application behaviour.
         Change in .app file: previously, <CODE>{start, {M, F, A}}</CODE>
         was specified, now <CODE>{mod, {M, A}}</CODE> should be specified,
         and <CODE>M:start(Type, A)</CODE> is called.

<BR>
<LI>     <CODE>code:root_dir/0</CODE>, <CODE>code:lib_dir/0</CODE>,
         <CODE>code:compiler_dir/0</CODE> and <CODE>code:uc_dir/0</CODE> returns
         a string.

        <BR>
<LI>     The <CODE>error_handler</CODE> is silent, e.g. it will not write
         <CODE>** cannot autoload: Mod **</CODE> and
         <CODE>** undefined registered name: Name **</CODE> to stdout any
         longer.
<BR>
</UL>
<A NAME="5.4"><!-- Empty --></A><H3>5.4 Known bugs and problems</H3><P>-
</BLOCKQUOTE>
<CENTER>
<HR>
<FONT SIZE=-1>
Copyright &copy; 1991-99
<A HREF="http://www.ericsson.se">Ericsson Utvecklings AB</A><BR>
<!--#include virtual="/ssi/otp_footer.html"-->
</FONT>
</CENTER>
</BODY>
</HTML>
