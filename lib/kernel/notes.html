<html>
<head>
  <title>Kernel Release Notes</title>
  <style type="text/css">
<!--
    body          { background: white; margin: 3em }

    body          { font-family: Verdana, Arial, Helvetica, sans-serif }
    h1 h2 h3 h4   { font-family: Verdana, Arial, Helvetica, sans-serif }
    h1            { font-size: 48 }
    p li          { font-family: Verdana, Arial, Helvetica, sans-serif }
-->
  </style>
</head>

<body bgcolor=white>

<center><h1>Kernel Release Notes</h1></center>


<!--- ################################################################# --->

<h2>Kernel 2.9</h2>


<!--- ----------------------------------------------------------------- --->

<h3>Fixed errors and malfunctions</h3>

<ul>

  <li>
    After a release upgrade, not all applications keys were updated. This
    has been corrected and all keys, as specified in the <CODE>.app</CODE>
    file, are now updated. This means
    <CODE>application:get_all_key/0,1</CODE> and
    <CODE>application:get_key/1,2</CODE> now returns up-to-date values also
    after a release upgrade.<br>
    (Own Id: OTP-4330)<br>
    (Aux Id: seq7346)<p>
  </li>

  <li>
    The options 'append' is no longer allowed together with 'compressed' to
    file:open/2 (previously ignored). And directories can no longer be
    opened with file:open/2 by using the 'compressed' flag.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4536)<p>
  </li>

  <li>
    Previously unexpected return values when calling gen_tcp:connect/3 with
    invalid Options values has been changed so the function exits when the
    option list contains invalid options, or is not a list.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4567)<p>
  </li>

  <li>
    If the shell process terminated during a user session, the shell simply
    freezed. Now an error message is printed out and - for local shell
    sessions - the shell process is restarted.<br>
    (Own Id: OTP-4615)<br>
    (Aux Id: seq7725)<p>
  </li>

  <li>
    Some more options for gen_tcp:connect/3,4, gen_tcp:listen/2,
    and gen_udp:open/3,4 are now documented.<br>
    (Own Id: OTP-4634)<p>
  </li>

  <li>
    A new class of error messages "warnings" are added. Warnings can be
    mapped to either error reports (the default), Info reports or a new
    class of reports, namely "warning reports". Non severe errors in OTP
    will be reported as warnings instead of forcing error reports.<br>
    (Own Id: OTP-4638)<br>
    (Aux Id: seq7788)<p>
  </li>

  <li>
    The <code>gen_tcp:shutdown/2</code> function has been added. To handle
    shutdown from the other side, the option <code>{exit_on_close,
    true|false}</code> has been added to the <code>inet:setops/2</code>
    function.<br>
    (Own Id: OTP-4664)<p>
  </li>

  <li>
    A deadlock could occur if a disk log was opened and closed by two
    processes at the same time.<br>
    (Own Id: OTP-4752)<br>
    (Aux Id: seq7902)<p>
  </li>

  <li>
    The BIF erlang:hibernate/3 allows a process to shrink its memory
    consumption while waiting for messages.<br>
    (Own Id: OTP-4727)<p>
  </li>

  <li>
    A code path cache has been implemented; it can be activated with
    code:rehash/0.<br>
    (Own Id: OTP-4741)<p>
  </li>

</ul>

<!--- ----------------------------------------------------------------- --->

<h3>Improvements and new features</h3>

<ul>

  <li>
    <P>A new function erlang:send/3 has been added to give more control to
    when to send if the sender risks being suspended or delayed due to
    automatic node connection. This function supersedes
    erlang:send_nosuspend/2,3, which is retained for backward
    compatibility, and has been upgraded to handle local processes and
    ports. See the documentation. <br> <P>The function gen_server:cast/2
    (and hence gen_server:abcast/2) has been corrected to not get stuck
    waiting for automatic node connection; if a node has to be connected
    for the cast to be sent, a helper process is spawned to do the send so
    that execution flow can return to the sender immediately.
    <P>The function gen_server:cast/2 has also been corrected to crash
    for invalid arguments.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-3968)<br>
    (Aux Id: Seq 4387)<p>
  </li>

  <li>
    Support for zombies has been removed. <code>erlang:system_flag/2</code>
    will no longer accept the <code>keep_zombies</code> argument.
    <code>process_info/2</code> will no longer accept the <code>exit</code>
    option (which was used to retrieve the exit reason for a zombie
    process).<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4523)<p>
  </li>

  <li>
    The <code>disk_log</code> module has been slightly changed for the
    purpose of reducing the risk of memory problems due to corrupt files.
    The <code>chunk</code> commands have been optimized by increasing the
    chunk size from 8 kilobytes to 64 kilobytes.<br>
    (Own Id: OTP-4530)<br>
    (Aux Id: seq7646)<p>
  </li>

  <li>
    The '{active,once}' option for <code>inet:setopts/2</code> is now
    documented.<br>
    (Own Id: OTP-4573)<p>
  </li>

  <li>
    A variant of rpc:multicall with timeout is added, and
    gen_server:multi_call has been fixed to discard late answers.<br>
    (Own Id: OTP-4586)<p>
  </li>

  <li>
    The cursor keys of VT compatible terminals works like the emacs control
    sequences for cursor positioning in the erlang interactive shell.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4613)<br>
    (Aux Id: seq7691)<p>
  </li>

  <li>
    erlang:memory/0 and erlang:memory/1 have been added.
    erlang:memory/[0,1] return the same type of information as
    c:memory/[0,1] previously did. The erlang:memory/[0,1] functions
    operate in constant time. c:memory/[0,1] now use erlang:memory/[0,1]
    and do therefore now also operate in constant time (which they
    previously did not). <br> erlang:memory/[0,1] return more accurate
    information than c:memory/[0,1] previously did. <br> For more
    information about erlang:memory/[0,1] see the erlang(3) man page.<br>
    (Own Id: OTP-4637)<p>
  </li>

  <li>
    To give applications better control of conversion of local time to UTC
    with respect to daylight saving time, there are two new functions:
    erlang:localtime_to_universaltime/2 and
    calendar:local_time_to_uinversal_time_dst/1. See the documentation for
    details.<br>
    (Own Id: OTP-4667)<br>
    (Aux Id: seq7797)<p>
  </li>

  <li>
    There is now a way to bind the erlang distribution socket to only one
    specific IP address on multihomed systems. Set the kernel variable
    'inet_dist_use_interface' to a net address e.g '{127,0,0,1}' (bad
    example).<br>
    (Own Id: OTP-4709)<br>
    (Aux Id: seq7806)<p>
  </li>

  <li>
    <p>A http state bug in inet_drv (affecting gen_tcp) has been fixed.
    Patch from Claes Wikström. <p>A bug in defining max number of ports has
    been fixed. Patch from Claes Wikström. <p>A bug in erlang:port_call/3
    when calling a driver with a NULL driver struct ->call field has been
    fixed. Patch from Luke Gorrie. <p>There is a new function
    file:script/1,2 that does the same as file:eval/1 but gives a return
    value. For completness, file:path_script/2,3, file:eval/2 and
    file:path_eval/3 are also added. Suggestion from Ulf Wiger. See the
    documentation for details. <p><code>erlang:trace/3</code> did no clear
    trace flags on processes that were exiting. This bug has now been
    fixed. <p>The gen_udp options <code>add_membership</code> and
    <code>drop_membership</code> are now allowed. Patch from Vance Shipley.
    <p><code>gen_udp:open/1,2</code> with service name instead of port
    number now works. Patch from carlos@lfcia.org. <p>An unjustified
    compiler warning when using an explicit space character as pad
    character to <code>io:format/2</code> and similar has been removed.
    <p>If an illegal node name is used to start a node, now
    <code>net_kernel</code> fails noisily instead of just letting the node
    start in non-distributed mode. <p>Now
    <code>gen_server:format_status/2</code> also works with non-registered
    processes. <p>There are two new functions
    <code>erlang:list_to_integer/2</code> and
    <code>erlang:integer_to_list/2</code> that takes a number base
    argument. See the documentataion for details. <p>New format characters
    for <code>io:format/2</code> and similar are ~b, ~B, ~x, ~X, ~+ and ~#.
    See the documentaion for details. <p>New format characters for
    <code>io:fread/2</code> and similar are ~u, ~- and ~#. See the
    documentation for details. <p>The token scanner <code>erl_scan</code>
    has been rewritten to become twice as fast as before. Now, incomplete
    any-base numbers such as "16#" are regarded as errors instead of as
    zero. The allowed base number range has been extended to 2..36 instead
    of previously 2..16. <p>There is a new function
    <code>lists:split/2</code>. See the documentation. <p>For everyone that
    has written their own function to calculate the time difference between
    two <code>now()</code> calls there is now
    <code>timer:now_diff/2</code>. See the documentation.<br>
    (Own Id: OTP-4747)<p>
  </li>

</ul>

<!--- ----------------------------------------------------------------- --->

<h3>Known problems</h3>

<ul>

  <li>
    <code>code:is_loaded/1</code> doesn't type check its arguments.<br>
    (Own Id: OTP-2607)<p>
  </li>

  <li>
    If more than 1024 bytes of text are pasted into the shell, and this
    text consists of more than one expression sequence (each ending with a
    period), text after the first 1024 bytes may be lost.<br>
    (Own Id: OTP-3041)<p>
  </li>

</ul>


<!--- ################################################################# --->

<h2>Kernel 2.8.0</h2>


<!--- ----------------------------------------------------------------- --->

<h3>Fixed errors and malfunctions</h3>

<ul>

  <li>
    A race condition in dist_ac has been removed. <br> The documentation
    didn't clearly state that all distributed applications depend on (at
    least) kernel and stdlib (kernel and stdlib should be part of
    "applications" in the .app file). This has now been added to the app(4)
    manual page. <br> The following has also been changed in the system
    documentation (not shipped with patches): PREVIOUSLY: When distributed
    applications are specified, it is advised that the sync_nodes
    functionality in the kernel application is used. If not used, and
    several nodes are started at the same time, the node that comes up
    first will start all applications, and the other nodes will take over
    the applications when they come up. <br> NOW: When distributed
    applications are specified, it is required that the sync_nodes
    functionality in the kernel application (see kernel(6)) is used to
    synchronize all involved nodes. If not used, the distribution mechanism
    for distributed applications will not function correctly.<br>
    (Own Id: OTP-3509)<br>
    (Aux Id: Seq 4408)<p>
  </li>

  <li>
    The spawn bifs didn't fail with badarg as they should if the argument
    list wasn't a list; instead, the spawned process immediately exited.
    All spawn BIFs now fail with badarg if they are passed a bad argument
    as argument list. <br> spawn BIFs which take funs as arguments and
    remote spawn BIFs could fail with other errors than badarg when passed
    bad arguments. All spawn BIFs now fail with badarg when they fail due
    to bad arguments.<br>
    (Own Id: OTP-4185)<p>
  </li>

  <li>
    A bug in <code>disk_log:unblock/1</code> that could cause messages to
    be processed in wrong order has been fixed. Write errors no longer
    terminate the disk log process.<br>
    (Own Id: OTP-4191)<p>
  </li>

  <li>
    The application module list is now properly updated after a code
    change.<br>
    (Own Id: OTP-4342)<p>
  </li>

  <li>
    A deadlock could occur if distributed disk logs were opened
    simultaneously on different nodes. This bug has been fixed.<br>
    (Own Id: OTP-4405)<br>
    (Aux Id: seq7275)<p>
  </li>

  <li>
    os:find_executable/1 would return wrong return values ({ok,Name} or
    error) if given an absolute path name instead of the documented values
    (Name or false).<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4476)<p>
  </li>

</ul>


<!--- ----------------------------------------------------------------- --->

<h3>Improvements and new features</h3>

<ul>

  <li>
    The spawn_opt/[2,3,5] BIFs has been added. That is, spawn_opts that
    takes a fun as argument, and spawn_opts that spawn a process on a
    remote node.<br>
    (Own Id: OTP-4180)<p>
  </li>

  <li>
    The sasl application variable 'log_utc' can be set to 'true' to make
    ordinary sasl logs as well as report browser output appear with
    Universal Coordinated Time instead of local time.<br>
    (Own Id: OTP-4245)<br>
    (Aux Id: Seq7242)<p>
  </li>

  <li>
    The set_net_ticktime/[1,2] and get_net_ticktime/0 functions has been
    added to the net_kernel module (see net_kernel(3)) which makes it
    possible to change the net_tick time during operation.<br>
    (Own Id: OTP-4255)<br>
    (Aux Id: SEQ-7249)<p>
  </li>

  <li>
    There are new functions <code>bchunk/2,3</code> in the
    <code>disk_log</code> module that are to be used like
    <code>chunk/2,3</code> but return objects as binaries.<br>
    (Own Id: OTP-4327)<p>
  </li>

  <li>
    The loading of BEAM code at start-up of embedded systems has been
    optimized: if the thread pool is non-empty (see the system flag
    <code>+A</code> in <code>erl(3)</code>) and files are read from a file
    system (the default, see the value <code>efile</code> of the
    <code>-loader</code> flag in <code>erl(3)</code>) disk seek times have
    been reduced.<br>
    (Own Id: OTP-4372)<p>
  </li>

  <li>
    There is a new configuration parameter 'shutdown_func' to application
    kernel that allows you to register a function to be called when
    application_controller shuts down. See the man page for 'kernel'.<br>
    (Own Id: OTP-4424)<br>
    (Aux Id: seq7520)<p>
  </li>

  <li>
    The module 'erlang' is now preloaded. Customized start scripts have to
    be rebuilt.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4433)<p>
  </li>

  <li>
    The option <code>compressed</code> to <code>file:open/2</code> has now
    been documented.<br>
    (Own Id: OTP-4513)<p>
  </li>

</ul>


<!--- ----------------------------------------------------------------- --->

<h3>Known problems</h3>

<ul>

  <li>
    <code>code:is_loaded/1</code> doesn't type check its arguments.<br>
    (Own Id: OTP-2607)<p>
  </li>

  <li>
    If more than 1024 bytes of text are pasted into the shell, and this
    text consists of more than one expression sequence (each ending with a
    period), text after the first 1024 bytes may be lost.<br>
    (Own Id: OTP-3041)<p>
  </li>

</ul>


There are also release notes for
<a href="notes_history.html">older versions</a>.

</body>
</html>
