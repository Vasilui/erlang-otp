<html>
<head>
  <title>Kernel Release Notes</title>
  <style type="text/css">
<!--
    body          { background: white; margin: 3em }

    body          { font-family: Verdana, Arial, Helvetica, sans-serif }
    h1 h2 h3 h4   { font-family: Verdana, Arial, Helvetica, sans-serif }
    h1            { font-size: 48 }
    p li          { font-family: Verdana, Arial, Helvetica, sans-serif }
-->
  </style>
</head>

<body bgcolor=white>

<center><h1>Kernel Release Notes</h1></center>


<!--- ################################################################# --->

<h2>Kernel 2.7</h2>


<!--- ----------------------------------------------------------------- --->

<h3>Fixed errors and malfunctions</h3>

<ul>

  <li>
    The undocumented and obsolete code:add_uc/1 and code:uc_dir/0 have been
    removed.<br>
    (Own Id: OTP-2933)<p>
  </li>

  <li>
    Bugs in <code>wrap_log_reader</code> have been fixed.<br>
    (Own Id: OTP-3736)<br>
    (Aux Id: OTP-3716)<p>
  </li>

  <li>
    <code>global:whereis_name/1</code> was unnecessarily inefficient.<br>
    (Own Id: OTP-3737)<br>
    (Aux Id: Seq 4935)<p>
  </li>

  <li>
    When making rpc:call to a function that in its
    turn spawn_linked some child process, the 
    rpc server killed the child process when the
    called function returned. This is now corrected.<br>
    (Own Id: OTP-3769)<br>
    (Aux Id: OTP-3766)<p>
  </li>

  <li>
    When many nodes contacted each other at the same time, there could be
    long delays until for example names registered using
    <code>global</code> were consistent on all nodes. This has been
    improved substantially.<br>
    (Own Id: OTP-3801)<br>
    (Aux Id: Seq 5028, OTP-3947)<p>
  </li>

  <li>
    A close of a tcp socket could be delayed up to 5 seconds after all
    pending output had been sent. Now the socket is closed immediately
    after all pending output has been sent.<br>
    (Own Id: OTP-3924)<br>
    (Aux Id: seq 5182, OTP-3963)<p>
  </li>

  <li>
    <code>unlink(Pid)</code> used to crash when performed on a
    non-distributed Erlang system, when <code>Pid</code> referred to a
    different node (obtained via terms stored in the file system, for
    example). Now it returns <code>true</code>.<br>
    (Own Id: OTP-3964)<br>
    (Aux Id: Seq 5232)<p>
  </li>

  <li>
    If a directory belonging to Erlang's code path was removed,
    <code>code:which/1</code> could crash.<br>
    (Own Id: OTP-3977)<br>
    (Aux Id: Seq 5253)<p>
  </li>

  <li>
    When resolving a clash between registered names during the connection
    of two partitions, a name would be removed if one of the nodes defining
    the name went down during the resolution. Now the name defined by the
    remaining node is kept.<br>
    (Own Id: OTP-3999)<p>
  </li>

  <li>
    dist_ac expects that all participating nodes have the same distribution
    specifications, but this wasn't clearly stated anywhere in the
    documentation. This has now been added to the system documentation.
    <p> Previously when dist_ac got an "application stopped" message about
    an application that it didn't know of, it crashed with a badmatch. Now
    dist_ac stores this information instead and assumes that the
    distribution specification for this application will be set later
    (trough application:load/2). <p> A stop of a distributed application
    has been changed to behave in the same way on all nodes in the
    distributed case. An application:stop/1 followed by an
    application:start/1 on any node will resume operation locally. <p>
    Documentation for application:stop/1 has been updated to describe it's
    behaviour in the distributed case.<br>
    (Own Id: OTP-4066)<br>
    (Aux Id: seq7093)<p>
  </li>

  <li>
    A documentation error for the bif nodes/1 has been fixed. Under "Some
    equalities" it was stated that "node() = nodes(this)" which is not
    correct. It has now been corrected to "[node()] = nodes(this)".<br>
    (Own Id: OTP-4131)<br>
    (Aux Id: Seq7152)<p>
  </li>

</ul>


<!--- ----------------------------------------------------------------- --->

<h3>Improvements and new features</h3>

<ul>

  <li>
    <code>disk_log</code> handles huge terms better when reading log files
    using <code>chunk/2</code>. Bugs in <code>chunk/2</code> and
    <code>chunk_step/3</code> as well as in <code>wrap_log_reader</code>
    have been fixed.<br>
    (Own Id: OTP-3716)<p>
  </li>

  <li>
    A number of bug fixes and improvements have been done to applications
    <CODE>runtime_tools</CODE>, <CODE>kernel</CODE> and <CODE>erts</CODE>:
    <UL> <br> <LI>A read timeout no longer resets the sequential trace
    token. This is an incompatibility towards the previous behaviour. Use
    <CODE>seq_trace:set_token([])</CODE> to reset the sequential trace
    token. <br> <LI><CODE>seq_trace:get_token/0</CODE> and
    <CODE>seq_trace:set_token/1</CODE> now have compatible token formats.
    <br> <LI><CODE>dbg:trace_port/2</CODE> and
    <CODE>dbg:trace_client/2,3</CODE> now supports trace to and read from a
    size limited "wrap file set". <br>
    <LI><CODE>dbg:trace_port_control/1</CODE> now supports operation
    <CODE>get_listen_port</CODE> for the ip trace driver. <br> <LI>New
    match spec functions <CODE>{is_seq_trace}</CODE> and
    <CODE>{get_seq_trace}</CODE> has been added to test and read the
    sequential trace token in match specs. <br> <LI>New match spec
    functions <CODE>{get_tcw}</CODE> and <CODE>{set_tcw Value}</CODE> that
    reads and sets a "trace control word" in the node has been added. The
    "trace control word" is a word in each Erlang node of at least 24 bits.
    There are also enhancements of BIFs:
    <CODE>erlang:system_info(trace_control_word)</CODE> and
    <CODE>erlang:system_flag(trace_control_word, Value)</CODE> for the same
    purpose. <br> <LI>A new match spec function <CODE>{silent,
    TrueOrFalse}</CODE> for setting a silent call trace flag per process
    that inhibits call trace messages, both local and global, has been
    added. The BIF <CODE>erlang:trace/3</CODE> has been extended to
    recognize the flag 'silent' to start a call trace in silent mode. <br>
    <LI>Some bugs in the <CODE>dbg</CODE> module has been fixed, e.g the
    'old_trace_call' flag has been removed from the 'all' flags list, and
    the dbg server no longer hangs if the supplied tracer fails to start.
    <br> <LI>A bug in the emulator that made 'EXIT' messages from a process
    involved in a sequential call trace get overwritten by the sequential
    trace token itself has been fixed. <br> <LI>The documentation regarding
    the above has been updated. Especially, the fact that the match spec
    function <CODE>{return_trace}</CODE> destroys the tail recursiveness of
    the traced function has been pointed out. <br> </UL><br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-3747)<br>
    (Aux Id: OTP-3592, OTP-3744)<p>
  </li>

  <li>
    <code>code:interpret/1</code>, <code>code:interpret_binary/3</code>,
    <code>code:delete_interpet/1</code> <code>code:interpeted/0</code> and
    <code>code:interpeted/1</code> have been removed since the debugger no
    longer needs them.<br>
    (Own Id: OTP-3783)<p>
  </li>

  <li>
    Hidden nodes and hidden global groups have been introduced. This makes
    it possible to establish hidden connections between Erlang nodes. See
    global_group(3), and erl(1).<br>
    (Own Id: OTP-3916)<br>
    (Aux Id: OTP-3963)<p>
  </li>

  <li>
    The flag 'procs' to erlang:trace/3 has got a slightly new behaviour:
    Trace tag 'spawn' has a new element, and trace tags 'register',
    'unregister', and 'getting_unlinked' are new. Therefore, new and/or
    different trace messages will arrive to the tracer when the 'procs'
    trace flag is used.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-3934)<br>
    (Aux Id: seq5193)<p>
  </li>

  <li>
    <CODE>disk_log</CODE> caches written terms. This implies that the
    <CODE>close</CODE>, <CODE>lclose</CODE> and <CODE>sync</CODE> functions
    can return file errors. <CODE>pid2name/1</CODE> is a new debug function
    that given a disk log process (a pid) returns the name of the log.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-3952)<p>
  </li>

  <li>
    A new command line argument <code>-extra</code> has been introduced,
    which causes all following arguments to remain uninterpreted by Erlang;
    the arguments are included in the list returned by
    <code>init:get_plain_arguments/0</code>.<br>
    (Own Id: OTP-3955)<br>
    (Aux Id: OTP-3030, Seq 5203)<p>
  </li>

  <li>
    Ports can now be registered in the same way as processes.<br>
    (Own Id: OTP-3989)<br>
    (Aux Id: Seq5263)<p>
  </li>

  <li>
    It is now possible to have the compiler check user-defined behaviours
    and not only the pre-defined OTP behaviours (gen_server etc.). <br>
    This is done by adding a function <CODE>behaviour_info/1</CODE> to the
    behaviour module. <CODE>behaviour_info(callbacks)</CODE> should return
    a list of <CODE>{FunctionName,Arity}</CODE> which defines the callback
    functions the behaviour uses. <br> When a callback module with the
    attribute <CODE>-behaviour(Behaviour)</CODE> is compiled, its exported
    functions will be compared with the list returned by
    <CODE>Behaviour:behaviour_info(callbacks)</CODE> and a warning will be
    issued if any callback function is missing. <br> Note that the user
    must ensure that the module <CODE>Behaviour</CODE> is present at
    compile-time and can be found in the current code path.<br>
    (Own Id: OTP-4125)<p>
  </li>

  <li>
    When the emulator runs without the async thread pool, large file read
    and write operations are now segmented into smaller, so that other
    Erlang processes can run in parallel. Still, a sync or a close
    operation on a large file may block the emulator as before. Using the
    async thread pool is the only cure for that.<br>
    (Own Id: OTP-4144)<p>
  </li>

</ul>


<!--- ----------------------------------------------------------------- --->

<h3>Known problems</h3>

<ul>

  <li>
    <code>code:is_loaded/1</code> doesn't type check its arguments.<br>
    (Own Id: OTP-2607)<p>
  </li>

  <li>
    If more than 1024 bytes of text are pasted into the shell, and this
    text consists of more than one expression sequence (each ending with a
    period), text after the first 1024 bytes may be lost.<br>
    (Own Id: OTP-3041)<p>
  </li>

</ul>



There are also release notes for
<a href="notes_history.html">older versions</a>.

</body>
</html>
