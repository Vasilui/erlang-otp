<html>
<head>
  <title>Compiler Release Notes</title>
  <style type="text/css">
<!--
    body          { background: white; margin: 3em }

    body          { font-family: Verdana, Arial, Helvetica, sans-serif }
    h1 h2 h3 h4   { font-family: Verdana, Arial, Helvetica, sans-serif }
    h1            { font-size: 48 }
    p li          { font-family: Verdana, Arial, Helvetica, sans-serif }
-->
  </style>
</head>

<body bgcolor=white>

<center><h1>Compiler Release Notes</h1></center>


<!--- ################################################################# --->

<h2>Compiler 4.2</h2>


<!--- ----------------------------------------------------------------- --->

<h3>Fixed errors and malfunctions</h3>

<ul>

  <li>
    Three compiler problems fixed: 1) Constant expression were not
    evaluated at compile time as they should be (unless inlining was turned
    on). 2) In unusual cases, incorrect code would be generated for "," or
    "and" in guards. 3) A floating point expressions that failed (e.g. with
    overflow) and whose value was not used would cause the next floating
    point expression to fail on some Pentium platforms (Linux, possibly
    FreeBSD; not on Windows).<br>
    (Own Id: OTP-4557)<p>
  </li>

  <li>
    Misspelled atom names which looks like arithmetic expressions no longer
    causes compiler crashes.<br>
    (Own Id: OTP-4617)<br>
    (Aux Id: seq7626)<p>
  </li>

  <li>
    Several minor compiler crash problems have been fixed.<br>
    (Own Id: OTP-4765)<p>
  </li>

  <li>
    Errors discovered by the Erlang pre-processor, such as re-definitions
    of macros, are now correctly reported. They used to be reported as
    "unknown POSIX error".<br>
    (Own Id: OTP-4768)<p>
  </li>

  <li>
    Under rare circumstances, a catch nested inside
    a catch in the same function would cause an emulator
    crash with the reason "Catch not found".<br>
    (Own Id: OTP-4769)<p>
  </li>

</ul>


<!--- ----------------------------------------------------------------- --->

<h3>Improvements and new features</h3>

<ul>
   <li>For the bit syntax, it is now supported to match with a sizefield
that is bound (from left to right) during the same matching. Example: <br>
     <code>&lt;&lt;Size, B:Size/binary,Rest/binary&gt;&gt; = &lt;&lt;2,"AB",3,"CDE"&gt;&gt;</code><br>
     During the matching Size is bound to 2 and then used as the size for
B which will be bound to "AB" etc.<br>
   </li>

  <li>
    The compiler will issue an warning for list comprenhensions without any
    generators.<br>
    (Own Id: OTP-4618)<p>
  </li>

  <li>
    The format of the debug information stored in beam files when the
    <code>debug_info</code> option is given has been changed. The debugger,
    xref, and cover tools in R9C have been updated to handle the new format
    (as well as the previous format). The R9B version of those tools
    <code>cannot</code> handle the new format.<br>
    (Own Id: OTP-4688)<p>
  </li>

  <li>
    When updating a record, the record is now always checked for the
    correct record tag and size. Earlier versions of the compiler did not
    consistently add such a test (depending on the size of the record and
    the number of fields updated).<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4764)<p>
  </li>

  <li>
    The compiler produces slightly smaller and faster code for certain
    language features, such as 'andalso' and 'orelse'.<br>
    (Own Id: OTP-4766)<p>
  </li>

</ul>


<!--- ################################################################# --->

<h2>Compiler 4.1</h2>


<!--- ----------------------------------------------------------------- --->

<h3>Fixed errors and malfunctions</h3>

<ul>

  <li>
    Fixed problem in optimizing of case patterns containing tuples.<br>
    (Own Id: OTP-3973)<br>
    (Aux Id: Seq 5243, Seq 7025)<p>
  </li>

  <li>
    Using the 'not' operator in guards could crash the emulator.<br>
    (Own Id: OTP-4194)<br>
    (Aux Id: seq7196, seq7232, seq7253)<p>
  </li>

  <li>
    A bug in the compilation of bit syntax matching could cause parts of
    the binary to be skipped.<br>
    (Own Id: OTP-4219)<br>
    (Aux Id: seq7218)<p>
  </li>

</ul>


<!--- ----------------------------------------------------------------- --->

<h3>Improvements and new features</h3>

<ul>

  <li>
    The documentation for the 'compile' module now lists several options
    that were previously undocumented or only documented in the 'erl_lint'
    documentation (such as the highly useful <tt>warn_unused_vars</tt>).<br>
    (Own Id: OTP-4240)<p>
  </li>

  <li>
    The <code>-include</code> and <code>-include_dir</code> directives
    substitute environment variable values for first path components
    beginning with a <code>$</code> (dollar) sign.<br>
    (Own Id: OTP-4385)<br>
    (Aux Id: seq7349)<p>
  </li>

  <li>
    The endianess specification 'native' has been added to the bit syntax.
    It will resolve to either big or little endian at load time. It is
    specially useful for communcating with linked-in drivers.<br>
    (Own Id: OTP-4458)<p>
  </li>

  <li>
    'try' and 'cond' are keywords in R9 and must not be used as atom names
    or field names in records (unless they are single-quoted). In the R9
    release, the compiler options 'disable_try' and 'disable_cond' can be
    used to allow 'try' and 'cond' to be used as in previous releases (to
    allow compilation of old Erlang code). <br> The
    'disable_try'/'disable_cond' options will be removed in the R10
    release.<br>
    (*** POTENTIAL INCOMPATIBILITY ***)<br>
    (Own Id: OTP-4464)<p>
  </li>

</ul>

There are also release notes for
<a href="notes_history.html">older versions</a>.

</body>
</html>
